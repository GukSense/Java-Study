``
김영한 강사님의 스프링 DB 데이터 접근핵심원리를 보고 복습을 위해 정리하였습니다. 
``
[강의링크](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-db-1)


## 락
### Lock 
- Lock 이란 트랜잭션 처리의 순차성을 보장하기 위한 방법
- DBMS 마다 Lock을 구현하는 방식과 세부적인 방법이 다름
- 따라서 효과적인 이용방법을 위해 해당 DB 의 Lock 에 대한 이해가 필요함
- DB 에서의 Lock은 동사보다는 명사의 느낌으로 많이 사용된다. 주로 *락을 획득한다.*, *락을 반납한다.* 라는 문장과 함께 사용됩니다.
### 락 상황 예시
1. autocommit false;
2. memberA의 money 를 12000원으로 세션A에서 변경
3. 이후 memberA money 를 20000원으로 세션B에서 변경

예를 들어 국민은행 계좌에서 Atm기를 통해 10000원을 출금하는 동시에 토스로 20000원을 다시 출금할려고 할 때,
**Atm기를 통한 트랜잭션 진행 중 에는 토스에서 진행하는 출금 트랜잭션이 실행이 되면 안될것** 
이러한 기능을 수행해주는 도구가 *Lock* 입니다.

즉 트랜잭션이 실행 중 일때 다른 세션에서  동시에 트랜잭션 작업을 할 수 없도록 독립성을 보장해주는것 Lock 이라고 볼 수 있다.
**트랜잭션 진행 순서**
1. autocommit false; 설정(트랜잭션 시작)
2. 해당 column의 Lock 존재 유무 확인 후, 있으면 획득
3. 변경 query 진행
4. commit or rollback
5. 획득했던 lock 반납

만약 트랜잭션 진행 중에 다른 세션에서 해당컬럼의 변경을 시도할려고하면 2번에서 걸려 락이 돌아올동안 대기를 하고 락이 돌아오면 트랜잭션을 진행합니다.
